{"version":3,"sources":["GetToken.tsx","hooks/useSymbols.ts","hooks/useLocalStorage.ts","SymbolsEditor.tsx","requestQueue.ts","Widget.tsx","hooks/useFinnhub.ts","WidgetList.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["GetToken","useState","token","setToken","onChange","useCallback","e","currentTarget","value","onSubmit","preventDefault","localStorage","setItem","window","location","reload","className","href","type","useSymbols","key","defaultValue","_setValue","useEffect","getItem","setValue","useLocalStorage","symbols","split","map","symbol","trim","setSymbols","join","SymbolsEditor","props","isInitialRender","setIsInitialRender","inputValues","setInputValues","console","log","values","requestQueue","pushReqest","url","callback","push","processRequestQueue","a","length","shift","axios","get","data","setTimeout","Widget","name","setName","current","setCurrent","change","setChange","chartData","setChartData","quoteUpdatedTime","setQuoteUpdatedTime","chartUpdatedTime","setChartUpdatedTime","getProfile","getQuote","c","o","updated","now","getCandles","end","moment","unix","start","subtract","i","x","y","quoteInterval","setInterval","candleInterval","clearInterval","useFinnhub","lastQuote","setLastQuote","lastQuoteChange","setLastQuoteChange","setClassName","timeout","clearTimeout","Math","round","width","height","margin","style","fill","strokeWidth","color","WidgetList","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"8KAwBeA,EAtBE,WAAO,IAAD,EACIC,mBAAS,IADb,mBACfC,EADe,KACRC,EADQ,KAGhBC,EAAWC,uBAAY,SAACC,GAC7BH,EAASG,EAAEC,cAAcC,SACvB,IAEGC,EAAWJ,uBAAY,SAACC,GAC7BA,EAAEI,iBACFC,aAAaC,QAAQ,oBAAqBV,GAC1CW,OAAOC,SAASC,WACd,CAACb,IAEJ,OAAO,8BACN,uBAAMO,SAAUA,EAAUO,UAAU,QAApC,UACC,kCAAO,mBAAGC,KAAK,sBAAR,qBAAP,gBACA,8BAAK,uBAAOC,KAAK,OAAOd,SAAUA,MAClC,8BAAK,uBAAOc,KAAK,SAASV,MAAM,mBCjBtBW,EAAa,WAAO,IAAD,ECAD,SAACC,EAAaC,GAA0B,IAAD,EACvCpB,mBAAwB,MADe,mBAC3DO,EAD2D,KACpDc,EADoD,KAelE,OAZAC,qBAAU,WACN,IAAIf,EAAQG,aAAaa,QAAQJ,GAEnB,OAAVZ,GACAG,aAAaC,QAAQQ,EAAKC,GAG9Bb,EAAQG,aAAaa,QAAQJ,GAE7BE,EAAUd,KACX,CAACY,EAAKC,IAEF,CACHb,QACEiB,SAAU,SAACjB,GACTG,aAAaC,QAAQQ,EAAKZ,GAC1Bc,EAAUd,KDlBUkB,CAAgB,kBAAoB,cAAxDlB,EADoB,EACpBA,MAAOiB,EADa,EACbA,SAEf,MAAO,CACHE,QAAO,OAAEnB,QAAF,IAAEA,OAAF,EAAEA,EAAOoB,MAAM,KAAKC,KAAI,SAACC,GAAD,OAAoBA,EAAOC,UACxDC,WAAY,SAACL,GACXF,EAASE,EAAQE,KAAI,SAACC,GAAD,OAAoBA,EAAOC,UAAQE,KAAK,UE+B1DC,EAhCO,SAACC,GAA+B,IAC1CR,EAAwBQ,EAAxBR,QAASK,EAAeG,EAAfH,WADgC,EAEH/B,oBAAS,GAFN,mBAE1CmC,EAF0C,KAEzBC,EAFyB,OAGXpC,mBAAmB,IAHR,mBAG1CqC,EAH0C,KAG7BC,EAH6B,KAKjDhB,qBAAU,WACFI,GAAWS,IACXI,QAAQC,IAAI,UAAWd,GAEvBY,EAAeZ,GACfU,GAAmB,MAExB,CAACV,EAASS,IAYb,OAAO,qBAAKpB,UAAU,iBAAf,SACH,sBAAMP,SAXW,SAACH,GAClBA,EAAEI,iBACFsB,EAAWM,IASX,SACI,uBAAOpB,KAAK,OAAOV,MAAO8B,EAAYL,KAAK,KAAM7B,SAPpC,SAACE,GAClB,IAAMoC,EAASpC,EAAEC,cAAcC,MAAMoB,MAAM,KAC3CW,EAAeG,W,kECrBjBC,EAAmC,GAE5BC,EAAa,SAACC,EAAaC,GACpCH,EAAaI,KAAK,CAAEF,MAAKC,cAGhBE,EAAmB,uCAAG,oCAAAC,EAAA,0DAC3BN,EAAaO,OADc,yBAEDP,EAAaQ,QAA/BN,EAFmB,EAEnBA,IAAKC,EAFc,EAEdA,SAFc,SAGJM,IAAMC,IAAIR,GAHN,gBAGnBS,EAHmB,EAGnBA,KAERd,QAAQC,IAAII,GAEZC,EAASQ,GAPkB,OAU/BC,WAAWP,EAAqB,KAVD,2CAAH,qDCsDjBQ,EAxDA,SAACrB,GAAwB,IAAD,ECHb,SAACL,GAAoB,IAAD,EAClB7B,mBAAS,IADS,mBACnCwD,EADmC,KAC7BC,EAD6B,OAEZzD,mBAAS,GAFG,mBAEnC0D,EAFmC,KAE1BC,EAF0B,OAGd3D,mBAAS,GAHK,mBAGnC4D,EAHmC,KAG3BC,EAH2B,OAIR7D,mBAAgB,IAJR,mBAInC8D,EAJmC,KAIxBC,EAJwB,OAMM/D,mBAAiB,GANvB,mBAMnCgE,EANmC,KAMjBC,EANiB,OAOMjE,mBAAiB,GAPvB,mBAOnCkE,EAPmC,KAOjBC,EAPiB,KASpCC,EAAahE,sBAAW,uCAAC,WAAOH,GAAP,eAAA+C,EAAA,sDACrBJ,EADqB,0DACoCf,EADpC,kBACoD5B,GAE/E0C,EAAWC,GAAK,SAACS,GACbI,EAAQJ,EAAKG,SAJU,2CAAD,sDAM3B,CAAC3B,IAEEwC,EAAWjE,sBAAW,uCAAC,WAAOH,GAAP,eAAA+C,EAAA,sDACnBJ,EADmB,iDAC6Bf,EAD7B,kBAC6C5B,GAEtE0C,EAAWC,GAAK,SAACS,GACb,IAAMK,EAAUL,EAAKiB,EACfV,EAASP,EAAKiB,EAAIjB,EAAKkB,EACvBC,EAAUC,gBAEhBd,EAAWD,GACXG,EAAUD,GACVK,EAAoBO,MAVC,2CAAD,sDAYzB,CAAC3C,IAEE6C,EAAatE,sBAAW,uCAAC,WAAOH,GAAP,mBAAA+C,EAAA,sDACrB2B,EAAMC,MAASC,OACfC,EAAQF,MAASG,SAAS,EAAG,UAAUF,OAEvCjC,EAJqB,wDAIkCf,EAJlC,kBAIkD5B,EAJlD,8BAI6E6E,EAJ7E,eAIyFH,GAEpHhC,EAAWC,GAAK,SAACS,GACb,IAAMS,EAAY,GAElB,GAAIT,EAAKiB,EACL,IAAK,IAAIU,EAAI,EAAGA,EAAI3B,EAAKiB,EAAErB,OAAQ+B,IAC/BlB,EAAUhB,KAAK,CAAEmC,EAAGD,EAAI,EAAGE,EAAG7B,EAAKiB,EAAEU,KAI7CjB,EAAaD,GACbK,EAAoBM,oBAhBG,2CAAD,sDAkB3B,CAAC5C,IA0BJ,OAxBAP,qBAAU,WACNiB,QAAQC,IAAI,gBAAiB,CAACX,EAAQuC,EAAYC,EAAUK,IAE5D,IAAMzE,EAAQS,aAAaa,QAAQ,qBAEnC6C,EAAWnE,GACXoE,EAASpE,GACTyE,EAAWzE,GAEX,IAAMkF,EAAgBC,aAAY,WAC9Bf,EAASpE,KAhEG,KAmEVoF,EAAiBD,aAAY,WAC/BV,EAAWzE,KAnEE,KAsEjB,OAAO,WACHqF,cAAcH,GACdG,cAAcD,MAEnB,CAACxD,EAAQuC,EAAYC,EAAUK,IAG3B,CACHlB,OACEE,UACAE,SACAE,YACAE,mBACAE,oBD7EuCqB,CAAWrD,EAAML,QAAtD2B,EAD2B,EAC3BA,KAAME,EADqB,EACrBA,QAASE,EADY,EACZA,OAAQE,EADI,EACJA,UADI,EAED9D,mBAAS0D,GAFR,mBAE5B8B,EAF4B,KAEjBC,EAFiB,OAGWzF,mBAAS,GAHpB,mBAG5B0F,EAH4B,KAGXC,EAHW,OAKD3F,mBAAS,UALR,mBAK5Be,EAL4B,KAKjB6E,EALiB,KA+BnC,OAxBAtE,qBAAU,WACFoC,IAAY8B,GACZG,EAAmBjC,EAAU8B,GAGjCC,EAAa/B,KACd,CAACA,EAAS8B,IAEblE,qBAAU,WAEFsE,EADAF,EAAkB,EACL,mBAEA,sBAGjB,IAAMG,EAAUvC,YAAW,WACvBsC,EAAa,YACd,KAEH,OAAO,WACHE,aAAaD,MAElB,CAACH,IAEG,sBAAK3E,UAAWA,EAAhB,UACH,sBAAKA,UAAU,iBAAf,UACI,sBAAKA,UAAU,UAAf,UACI,6BAAKmB,EAAML,SACX,4BAAI2B,OAGR,sBAAKzC,UAAU,QAAf,UACI,6BAAK2C,IACL,mBAAG3C,UAAW6C,EAAS,EAAI,MAAQ,QAAnC,SAA6CmC,KAAKC,MAAe,IAATpC,GAAgB,YAK5EE,EAAUb,OACJ,qBAAKlC,UAAU,QAAf,SACE,cAAC,IAAD,CAAQkF,MAAO,IAAKC,OAAQ,GAAIC,OAAQ,EAAGC,MAAO,CAAEC,KAAM,QAA1D,SACI,cAAC,IAAD,CAAYC,YAAa,EAAGC,MAAOzC,EAAUA,EAAUb,OAAS,GAAGiC,EAAIpB,EAAU,GAAGoB,EAAI,EAAI,UAAY,UAAW7B,KAAMS,QAG/H,SE3CH0C,EAdI,WAAO,IAAD,EACQtF,IAAxBQ,EADgB,EAChBA,QAASK,EADO,EACPA,WAEjB,OAAO,qCACN,cAAC,EAAD,CAAeL,QAASA,EAASK,WAAYA,IAE7C,qBAAKhB,UAAU,cAAf,gBAEEW,QAFF,IAEEA,OAFF,EAEEA,EAASE,KAAI,SAACC,GAAD,OAAoB,cAAC,EAAD,CAAqBA,OAAQA,GAAhBA,YCAnC4E,EAVH,WACX,OAAK/F,aAAaa,QAAQ,qBAInB,qBAAKR,UAAU,MAAf,SACN,cAAC,EAAD,MAJO,cAAC,EAAD,KCSM2F,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,O,MCDdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAG1BxE,IAMA2D,M","file":"static/js/main.f4cb579f.chunk.js","sourcesContent":["import { ChangeEvent, FormEvent, useState, useCallback } from \"react\"\n\nconst GetToken = () => {\n\tconst [token, setToken] = useState(\"\")\n\n\tconst onChange = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n\t\tsetToken(e.currentTarget.value)\n\t}, [])\n\n\tconst onSubmit = useCallback((e: FormEvent<HTMLFormElement>) => {\n\t\te.preventDefault()\n\t\tlocalStorage.setItem(\"finnhub_api_token\", token)\n\t\twindow.location.reload()\n\t}, [token])\n\n\treturn <div>\n\t\t<form onSubmit={onSubmit} className=\"token\">\n\t\t\t<label><a href=\"https://finnhub.io/\">Finnhub</a> API Token</label>\n\t\t\t<div><input type=\"text\" onChange={onChange} /></div>\n\t\t\t<div><input type=\"submit\" value=\"Submit\" /></div>\n\t\t</form>\n\t</div>\n}\n\nexport default GetToken","import { useLocalStorage } from \"./useLocalStorage\"\n\nexport const useSymbols = () => {\n    const { value, setValue } = useLocalStorage(\"finnhub_symbols\",  \"AAPL, NVDA\")\n\n    return {\n        symbols: value?.split(\",\").map((symbol: string) => symbol.trim())\n        , setSymbols: (symbols: string[]) => {\n            setValue(symbols.map((symbol: string) => symbol.trim()).join(\", \"))\n        }\n    }\n}","import { useState, useEffect } from \"react\"\n\nexport const useLocalStorage = (key: string, defaultValue: string) => {\n    const [value, _setValue] = useState<string | null>(null)\n\n    useEffect(() => {\n        let value = localStorage.getItem(key)\n        \n        if (value === null) {\n            localStorage.setItem(key, defaultValue)\n        }\n\n        value = localStorage.getItem(key)\n\n        _setValue(value!)\n    }, [key, defaultValue])\n\n    return {\n        value\n        , setValue: (value: string) => {\n            localStorage.setItem(key, value)\n            _setValue(value)\n        }\n    }\n}","import { useEffect, useState, FormEvent, ChangeEvent } from \"react\"\n\ninterface SymbolsEditorProps {\n    symbols: string[] | undefined\n    setSymbols: (symbols: string[]) => void\n}\n\nconst SymbolsEditor = (props: SymbolsEditorProps) => {\n    const { symbols, setSymbols } = props\n    const [isInitialRender, setIsInitialRender] = useState(true)\n    const [inputValues, setInputValues] = useState<string[]>([])\n\n    useEffect(() => {\n        if (symbols && isInitialRender) {\n            console.log(\"symbols\", symbols)\n\n            setInputValues(symbols)\n            setIsInitialRender(false)\n        }\n    }, [symbols, isInitialRender])\n\n    const handleSubmit = (e: FormEvent) => {\n        e.preventDefault()\n        setSymbols(inputValues)\n    }\n\n    const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n        const values = e.currentTarget.value.split(\",\")\n        setInputValues(values!)\n    }\n\n    return <div className=\"symbols-editor\">\n        <form onSubmit={handleSubmit}>\n            <input type=\"text\" value={inputValues.join(\",\")} onChange={handleChange} />\n            {/* <input type=\"submit\" value=\"Update\" /> */}\n        </form>\n    </div>\n}\n\nexport default SymbolsEditor","import axios from \"axios\"\n\ninterface RequestQueueItem {\n    url: string\n    callback: (data: any) => void\n}\n\nconst requestQueue: RequestQueueItem[] = []\n\nexport const pushReqest = (url: string, callback: (data: any) => void) => {\n    requestQueue.push({ url, callback })\n}\n\nexport const processRequestQueue = async () => {\n    if (requestQueue.length) {\n        const { url, callback } = requestQueue.shift()!\n        const { data } = await axios.get(url)\n        \n        console.log(url)\n        \n        callback(data)\n    }\n\n    setTimeout(processRequestQueue, 1000)\n}","import { useEffect, useState } from 'react'\n\n// @ts-ignore\nimport { XYPlot, LineSeries } from 'react-vis'\n\nimport { useFinnhub } from \"./hooks/useFinnhub\"\n\nexport interface WidgetProps {\n    symbol: string\n}\n\nconst Widget = (props: WidgetProps) => {\n    const { name, current, change, chartData } = useFinnhub(props.symbol)\n    const [lastQuote, setLastQuote] = useState(current)\n    const [lastQuoteChange, setLastQuoteChange] = useState(0)\n\n    const [className, setClassName] = useState(\"widget\")\n\n    useEffect(() => {\n        if (current !== lastQuote) {\n            setLastQuoteChange(current - lastQuote)\n        }\n\n        setLastQuote(current)\n    }, [current, lastQuote])\n\n    useEffect(() => {\n        if (lastQuoteChange < 0) {\n            setClassName(\"widget blink-red\")\n        } else {\n            setClassName(\"widget blink-green\")\n        }\n\n        const timeout = setTimeout(() => {\n            setClassName(\"widget\")\n        }, 1000)\n\n        return () => {\n            clearTimeout(timeout)\n        }\n    }, [lastQuoteChange])\n\n    return <div className={className}>\n        <div className=\"grid-container\">\n            <div className=\"profile\">\n                <h3>{props.symbol}</h3>\n                <p>{name}</p>\n            </div>\n\n            <div className=\"quote\">\n                <h3>{current}</h3>\n                <p className={change < 0 ? \"red\" : \"green\"}>{Math.round(change * 100) / 100}</p>\n            </div>\n        </div>\n\n        {\n            chartData.length\n                ? <div className=\"chart\">\n                    <XYPlot width={300} height={80} margin={0} style={{ fill: \"none\" }} >\n                        <LineSeries strokeWidth={2} color={chartData[chartData.length - 1].y - chartData[0].y < 0 ? \"#dc322f\" : \"#859900\"} data={chartData} />\n                    </XYPlot>\n                </div>\n                : null\n        }\n    </div>\n}\n\nexport default Widget","import { useCallback, useEffect, useState } from \"react\"\nimport moment, { now } from \"moment\"\n\nimport { pushReqest } from \"../requestQueue\"\n\nconst quoteIntervalMS = 30000\nconst candleIntervalMS = 300000\n\nexport const useFinnhub = (symbol: string) => {\n    const [name, setName] = useState(\"\")\n    const [current, setCurrent] = useState(0.0)\n    const [change, setChange] = useState(0.0)\n    const [chartData, setChartData] = useState<any[]>([])\n\n    const [quoteUpdatedTime, setQuoteUpdatedTime] = useState<number>(0)\n    const [chartUpdatedTime, setChartUpdatedTime] = useState<number>(0)\n\n    const getProfile = useCallback(async (token: string) => {\n        const url = `https://finnhub.io/api/v1/stock/profile2?symbol=${symbol}&token=${token}`\n\n        pushReqest(url, (data: any) => {\n            setName(data.name)\n        })\n    }, [symbol])\n\n    const getQuote = useCallback(async (token: string) => {\n        const url = `https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${token}`\n\n        pushReqest(url, (data: any) => {\n            const current = data.c\n            const change = data.c - data.o\n            const updated = now()\n\n            setCurrent(current)\n            setChange(change)\n            setQuoteUpdatedTime(updated)\n        })\n    }, [symbol])\n\n    const getCandles = useCallback(async (token: string) => {\n        const end = moment().unix()\n        const start = moment().subtract(6, 'months').unix()\n\n        const url = `https://finnhub.io/api/v1/stock/candle?symbol=${symbol}&token=${token}&resolution=D&from=${start}&to=${end}`\n\n        pushReqest(url, (data: any) => {\n            const chartData = []\n\n            if (data.c) {\n                for (let i = 0; i < data.c.length; i++) {\n                    chartData.push({ x: i + 1, y: data.c[i] })\n                }\n            }\n\n            setChartData(chartData)\n            setChartUpdatedTime(now())\n        })\n    }, [symbol])\n\n    useEffect(() => {\n        console.log(\"dependencies:\", [symbol, getProfile, getQuote, getCandles])\n\n        const token = localStorage.getItem(\"finnhub_api_token\")!\n\n        getProfile(token)\n        getQuote(token)\n        getCandles(token)\n\n        const quoteInterval = setInterval(() => {\n            getQuote(token)\n        }, quoteIntervalMS)\n\n        const candleInterval = setInterval(() => {\n            getCandles(token)\n        }, candleIntervalMS)\n\n        return () => {\n            clearInterval(quoteInterval)\n            clearInterval(candleInterval)\n        }\n    }, [symbol, getProfile, getQuote, getCandles])\n\n\n    return {\n        name\n        , current\n        , change\n        , chartData\n        , quoteUpdatedTime\n        , chartUpdatedTime\n    }\n}","import { useSymbols } from \"./hooks/useSymbols\"\n\nimport SymbolsEditor from \"./SymbolsEditor\"\nimport Widget from \"./Widget\"\n\nconst WidgetList = () => {\n\tconst { symbols, setSymbols } = useSymbols()\n\n\treturn <>\n\t\t<SymbolsEditor symbols={symbols} setSymbols={setSymbols} />\n        \n\t\t<div className=\"widget-list\">\n\t\t\t{\n\t\t\t\tsymbols?.map((symbol: string) => <Widget key={symbol} symbol={symbol} />)\n\t\t\t}\n\t\t</div>\n\t</>\n}\n\nexport default WidgetList","import GetToken from \"./GetToken\"\nimport WidgetList from \"./WidgetList\"\n\nconst App = () => {\n\tif (!localStorage.getItem(\"finnhub_api_token\")) {\n\t\treturn <GetToken />\n\t}\n\n\treturn <div className=\"App\">\n\t\t<WidgetList />\n\t</div>\n}\n\nexport default App","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\nimport { processRequestQueue } from \"./requestQueue\"\n\nimport './index.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\nprocessRequestQueue()\n\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}